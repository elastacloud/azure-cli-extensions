import unittest
from unittest.mock import MagicMock
from azext_block.models import (ApplicationGatewayBuildingBlock, ApplicationGateway)

class ApplicationGatewayTest(unittest.TestCase):
    _staticRG = frozenset(["resourceGroup1", "resourceGroup2"])

    #_settings = "[{'additional_properties': {'redirectConfigurations': [], 'virtualNetwork': {'name': 'simple-vnet', 'subscriptionId': '2a8545f9-dc4c-43f5-aea4-7a4a5df8c835', 'resourceGroupName': 'mspnp10', 'location': 'northeurope'}}, 'id': '/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp10/providers/Microsoft.Network/ApplicationGateways/my-test-agw1', '_validation': {'name': {'required': True}, 'subscription_id': {'required': True, 'custom': <function is_guid at 0x06783F60>}, 'resource_group_name': {'required': True, 'pattern': '^[-\\w\\._\\(\\)]{0,89}[-\\w_\\(\\)]$'}, 'location': {'required': True}, 'tags': {'required': True, 'custom': <bound method TaggedResource._validate_tags of <azext_block.models.application_gateway.ApplicationGateway object at 0x079C68D0>>}, 'sku': {'required': True}, 'gateway_ip_configurations': {'required': True, 'min_items': 1}, 'frontend_ip_configurations': {'required': True, 'min_items': 1}, 'backend_address_pools': {'required': True, 'min_items': 1}, 'backend_http_settings_collection': {'required': True, 'min_items': 1}, 'http_listeners': {'required': True, 'min_items': 1}, 'url_path_maps': {'required': True, 'min_items': 1}, 'requesting_routing_rules': {'required': True, 'min_items': 1}, 'web_application_firewall_configuration': {'required': True}, 'probes': {'required': True, 'min_items': 1}, 'ssl_certificates': {'required': True, 'min_items': 1}, 'frontend_ports': {'required': True, 'min_items': 1}, 'id': {'required': False}}, '_validation_messages': {}, 'name': 'my-test-agw1', 'subscription_id': '2a8545f9-dc4c-43f5-aea4-7a4a5df8c835', 'resource_group_name': 'mspnp10', 'location': 'northeurope', 'tags': {}, 'sku': <azure.mgmt.network.v2017_10_01.models.application_gateway_sku_py3.ApplicationGatewaySku object at 0x079C6CF0>, 'gateway_ip_configurations': [<azext_block.models.application_gateway.GatewayIPConfiguration object at 0x079C6A10>], 'frontend_ip_configurations': [<azext_block.models.application_gateway.FrontendIPConfiguration object at 0x079C69D0>, <azext_block.models.application_gateway.FrontendIPConfiguration object at 0x079C6AB0>], 'backend_address_pools': [<azext_block.models.application_gateway.BackendAddressPool object at 0x079C69B0>, <azext_block.models.application_gateway.BackendAddressPool object at 0x079C6A50>], 'backend_http_settings_collection': [<azext_block.models.application_gateway.BackendHttpSettings object at 0x079C6B10>, <azext_block.models.application_gateway.BackendHttpSettings object at 0x079C6A90>], 'http_listeners': [<azext_block.models.application_gateway.HttpListener object at 0x079C6B90>, <azext_block.models.application_gateway.HttpListener object at 0x079C6BB0>, <azext_block.models.application_gateway.HttpListener object at 0x079C6BD0>], 'url_path_maps': [<azext_block.models.application_gateway.UrlPathMap object at 0x079C6B50>], 'request_routing_rules': [<azext_block.models.application_gateway.RequestRoutingRule object at 0x079C6B70>, <azext_block.models.application_gateway.RequestRoutingRule object at 0x079C6AF0>, <azext_block.models.application_gateway.RequestRoutingRule object at 0x079C6C10>], 'web_application_firewall_configuration': <azure.mgmt.network.v2017_10_01.models.application_gateway_web_application_firewall_configuration_py3.ApplicationGatewayWebApplicationFirewallConfiguration object at 0x079C6D90>, 'probes': [<azext_block.models.application_gateway.Probe object at 0x079C6C90>], 'ssl_certificates': None, 'authentication_certificates': [<azext_block.models.application_gateway.AuthenticationCertificate object at 0x079C6970>], 'frontend_ports': [<azext_block.models.application_gateway.FrontendPort object at 0x079C6C30>, <azext_block.models.application_gateway.FrontendPort object at 0x079C6C50>, <azext_block.models.application_gateway.FrontendPort object at 0x079C6CD0>], 'ssl_policy': <azure.mgmt.network.v2017_10_01.models.application_gateway_ssl_policy_py3.ApplicationGatewaySslPolicy object at 0x079C6D50>}]"
    _settings = []
    _appGateway = ApplicationGateway(sku=None, gateway_ip_configurations=None, frontend_ip_configurations=None, backend_http_settings_collection=None, backend_address_pools=None, http_listeners=None, redirect_configurations=None, url_path_maps=None, request_routing_rules=None, web_application_firewall_configuration=None, probes=None, ssl_certificates=None, authentication_certificates=None, frontend_ports=None,ssl_policy=None)
    
    def setUp(self):
        self.target = ApplicationGatewayBuildingBlock(self._appGateway)
        self.target.proxy_extract_resource_groups = MagicMock(return_value=self._staticRG)

    def test_transform_uses_settings(self):
        resultRG, _ = self.target.transform()
        self.assertCountEqual(resultRG, self._staticRG)