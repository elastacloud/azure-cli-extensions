{"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#", "contentVersion": "1.0.0.0", "parameters": {"applicationGateways": {"value": [{"subscriptionId": "2a8545f9-dc4c-43f5-aea4-7a4a5df8c835", "resourceGroupName": "mspnp3", "name": "my-test-agw1", "location": "northeurope", "properties": {"sku": {"name": "WAF_Medium", "tier": "WAF", "capacity": 2}, "sslPolicy": {}, "gatewayIPConfigurations": [{"properties": {"subnet": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/virtualNetworks/simple-vnet/subnets/default1"}}, "name": "appGatewayIpConfig"}], "authenticationCertificates": [{"properties": {"data": "MIIC+DCCAeCgAwIBAgIQW/9u7rO8WpFCyvOlIp64gjANBgkqhkiG9w0BAQUFADAPMQ0wCwYDVQQDDAR0ZXN0MB4XDTE3MDkwNjE0Mjc1N1oXDTE4MDkwNjE0NDc1N1owDzENMAsGA1UEAwwEdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANUpP4PUiFaDydy0pXo5ZkHCJHFO9InhLyL8Xes5efMdrq6EJ5G/LzDgWlm6XPD6Qk1mhwkQD/rjcr6gcNyrtdM0XLpFm2Kfjxgk4PvV28bIdsU+X7npgT4E8KfqAAGdaUc99HUvBf+2GdnekwvIckOBobYfNdIq6souDK8TvJcfimimHje3aLgI/3+n4u8uK9mJMaCgTlQwEZn3p1/si/9YgRmfns1ftT+P3Sdbze3QNomyz5sRXsBsco/EodmwUpy9FtblE1uG1e8PcOMZoTncuMBgfV2y6t2SlLkSjM9j1wmfiN0Ddx712mYuIQesMrbv53MFcZ0mXiTRXtMwvzkCAwEAAaNQME4wDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATAdBgNVHQ4EFgQUIquZHpmWq+0hQ26P2OXU+Aaj5okwDQYJKoZIhvcNAQEFBQADggEBAFCsJlbqZT92skNG9VLZ6bcjQxGAyGjtHr/L6WU+I+dSjUB2QehgMwkZ7tx9kLoPXgkH/nexZ+DgJNA38GlFy1lpfymqMITT63YaiAd912lqU1uEi4EwfSm0V6SibplGMO1ddDFb4siyV9WHQ6VVjyTuySthiWrXauqggDU5wt0MeyeNvvmkIOxAdVQOPGdX/8PPKBF5LCONvlludOs1wMASp2WkA97QKyxnawSqKtMkl7/5gOdFzD37h5i3UOoMWXa8cGmAzyogToqCF+i2hXQui3HAYJjk/uB/Ux3ciDAY04D+rcs9i8Qkv5BRVEAU/dm310g0Dl1IRfVL73nmfTo="}, "name": "authtest"}], "frontendIPConfigurations": [{"properties": {"privateIPAllocationMethod": "Dynamic", "publicIPAddress": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/publicIPAddresses/my-test-agw1-appGatewayFrontendIP"}}, "name": "appGatewayFrontendIP"}, {"properties": {"privateIPAllocationMethod": "Dynamic", "subnet": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/virtualNetworks/simple-vnet/subnets/default1"}}, "name": "testfec"}], "frontendPorts": [{"properties": {"port": 80}, "name": "appGatewayFrontendPort"}, {"properties": {"port": 81}, "name": "list1-http1"}, {"properties": {"port": 82}, "name": "list-http2"}], "probes": [{"properties": {"protocol": "Http", "host": "contoso.com", "path": "/", "interval": 30, "timeout": 30, "unhealthyThreshold": 3, "pickHostNameFromBackendHttpSettings": false, "minServers": 0}, "name": "p1"}], "backendAddressPools": [{"properties": {"backendAddresses": [{"fqdn": "www.contoso.com"}]}, "name": "appGatewayBackendPool"}, {"name": "bp2"}], "backendHttpSettingsCollection": [{"properties": {"port": 80, "protocol": "Http", "cookieBasedAffinity": "Disabled", "requestTimeout": 30, "pickHostNameFromBackendAddress": false, "probeEnabled": true}, "name": "appGatewayBackendHttpSettings"}, {"properties": {"port": 80, "protocol": "Http", "cookieBasedAffinity": "Enabled", "requestTimeout": 20, "probe": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/probes/p1"}, "pickHostNameFromBackendAddress": false, "probeEnabled": true}, "name": "test-settings"}], "httpListeners": [{"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendIPConfigurations/appGatewayFrontendIP"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendPorts/appGatewayFrontendPort"}, "protocol": "Http"}, "name": "appGatewayHttpListener"}, {"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendIPConfigurations/testfec"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendPorts/list1-http1"}, "protocol": "Http"}, "name": "list1"}, {"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendIPConfigurations/testfec"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/frontendPorts/list-http2"}, "protocol": "Http"}, "name": "list2"}], "urlPathMaps": [{"properties": {"defaultBackendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendAddressPools/appGatewayBackendPool"}, "defaultBackendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}, "pathRules": [{"properties": {"paths": ["/foo"], "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendAddressPools/bp2"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendHttpSettingsCollection/test-settings"}}, "name": "p1"}, {"properties": {"paths": ["/bar"], "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendAddressPools/appGatewayBackendPool"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}}, "name": "p2"}]}, "name": "pb-rule1"}], "requestRoutingRules": [{"properties": {"ruleType": "Basic", "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendAddressPools/appGatewayBackendPool"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}, "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/httpListeners/appGatewayHttpListener"}}, "name": "rule1"}, {"properties": {"ruleType": "Basic", "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendAddressPools/bp2"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/backendHttpSettingsCollection/test-settings"}, "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/httpListeners/list1"}}, "name": "rule2"}, {"properties": {"ruleType": "PathBasedRouting", "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/httpListeners/list2"}, "urlPathMap": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw1/urlPathMaps/pb-rule1"}}, "name": "pb-rule1"}]}}, {"subscriptionId": "2a8545f9-dc4c-43f5-aea4-7a4a5df8c835", "resourceGroupName": "mspnp3", "name": "my-test-agw2", "location": "northeurope", "properties": {"sku": {"name": "WAF_Medium", "tier": "WAF", "capacity": 2}, "sslPolicy": {}, "gatewayIPConfigurations": [{"properties": {"subnet": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/virtualNetworks/simple-vnet/subnets/default2"}}, "name": "appGatewayIpConfig"}], "authenticationCertificates": [{"properties": {"data": "MIIC+DCCAeCgAwIBAgIQW/9u7rO8WpFCyvOlIp64gjANBgkqhkiG9w0BAQUFADAPMQ0wCwYDVQQDDAR0ZXN0MB4XDTE3MDkwNjE0Mjc1N1oXDTE4MDkwNjE0NDc1N1owDzENMAsGA1UEAwwEdGVzdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANUpP4PUiFaDydy0pXo5ZkHCJHFO9InhLyL8Xes5efMdrq6EJ5G/LzDgWlm6XPD6Qk1mhwkQD/rjcr6gcNyrtdM0XLpFm2Kfjxgk4PvV28bIdsU+X7npgT4E8KfqAAGdaUc99HUvBf+2GdnekwvIckOBobYfNdIq6souDK8TvJcfimimHje3aLgI/3+n4u8uK9mJMaCgTlQwEZn3p1/si/9YgRmfns1ftT+P3Sdbze3QNomyz5sRXsBsco/EodmwUpy9FtblE1uG1e8PcOMZoTncuMBgfV2y6t2SlLkSjM9j1wmfiN0Ddx712mYuIQesMrbv53MFcZ0mXiTRXtMwvzkCAwEAAaNQME4wDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggrBgEFBQcDATAdBgNVHQ4EFgQUIquZHpmWq+0hQ26P2OXU+Aaj5okwDQYJKoZIhvcNAQEFBQADggEBAFCsJlbqZT92skNG9VLZ6bcjQxGAyGjtHr/L6WU+I+dSjUB2QehgMwkZ7tx9kLoPXgkH/nexZ+DgJNA38GlFy1lpfymqMITT63YaiAd912lqU1uEi4EwfSm0V6SibplGMO1ddDFb4siyV9WHQ6VVjyTuySthiWrXauqggDU5wt0MeyeNvvmkIOxAdVQOPGdX/8PPKBF5LCONvlludOs1wMASp2WkA97QKyxnawSqKtMkl7/5gOdFzD37h5i3UOoMWXa8cGmAzyogToqCF+i2hXQui3HAYJjk/uB/Ux3ciDAY04D+rcs9i8Qkv5BRVEAU/dm310g0Dl1IRfVL73nmfTo="}, "name": "authtest"}], "frontendIPConfigurations": [{"properties": {"privateIPAllocationMethod": "Dynamic", "publicIPAddress": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/publicIPAddresses/my-test-agw2-appGatewayFrontendIP"}}, "name": "appGatewayFrontendIP"}, {"properties": {"privateIPAllocationMethod": "Dynamic", "subnet": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/virtualNetworks/simple-vnet/subnets/default2"}}, "name": "testfec"}], "frontendPorts": [{"properties": {"port": 80}, "name": "appGatewayFrontendPort"}, {"properties": {"port": 81}, "name": "list1-http1"}, {"properties": {"port": 82}, "name": "list-http2"}], "probes": [{"properties": {"protocol": "Http", "host": "contoso.com", "path": "/", "interval": 30, "timeout": 30, "unhealthyThreshold": 3, "pickHostNameFromBackendHttpSettings": false, "minServers": 0}, "name": "p1"}], "backendAddressPools": [{"properties": {"backendAddresses": [{"fqdn": "www.contoso.com"}]}, "name": "appGatewayBackendPool"}, {"name": "bp2"}], "backendHttpSettingsCollection": [{"properties": {"port": 80, "protocol": "Http", "cookieBasedAffinity": "Disabled", "requestTimeout": 30, "pickHostNameFromBackendAddress": false, "probeEnabled": true}, "name": "appGatewayBackendHttpSettings"}, {"properties": {"port": 80, "protocol": "Http", "cookieBasedAffinity": "Enabled", "requestTimeout": 20, "probe": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/probes/p1"}, "pickHostNameFromBackendAddress": false, "probeEnabled": true}, "name": "test-settings"}], "httpListeners": [{"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendIPConfigurations/appGatewayFrontendIP"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendPorts/appGatewayFrontendPort"}, "protocol": "Http"}, "name": "appGatewayHttpListener"}, {"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendIPConfigurations/testfec"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendPorts/list1-http1"}, "protocol": "Http"}, "name": "list1"}, {"properties": {"frontendIPConfiguration": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendIPConfigurations/testfec"}, "frontendPort": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/frontendPorts/list-http2"}, "protocol": "Http"}, "name": "list2"}], "urlPathMaps": [{"properties": {"defaultBackendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendAddressPools/appGatewayBackendPool"}, "defaultBackendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}, "pathRules": [{"properties": {"paths": ["/foo"], "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendAddressPools/bp2"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendHttpSettingsCollection/test-settings"}}, "name": "p1"}, {"properties": {"paths": ["/bar"], "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendAddressPools/appGatewayBackendPool"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}}, "name": "p2"}]}, "name": "pb-rule1"}], "requestRoutingRules": [{"properties": {"ruleType": "Basic", "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendAddressPools/appGatewayBackendPool"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendHttpSettingsCollection/appGatewayBackendHttpSettings"}, "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/httpListeners/appGatewayHttpListener"}}, "name": "rule1"}, {"properties": {"ruleType": "Basic", "backendAddressPool": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendAddressPools/bp2"}, "backendHttpSettings": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/backendHttpSettingsCollection/test-settings"}, "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/httpListeners/list1"}}, "name": "rule2"}, {"properties": {"ruleType": "PathBasedRouting", "httpListener": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/httpListeners/list2"}, "urlPathMap": {"id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/applicationGateways/my-test-agw2/urlPathMaps/pb-rule1"}}, "name": "pb-rule1"}]}}]}, "publicIpAddresses": {"value": [{"subscriptionId": "2a8545f9-dc4c-43f5-aea4-7a4a5df8c835", "resourceGroupName": "mspnp3", "id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/publicIPAddresses/my-test-agw1-appGatewayFrontendIP", "name": "my-test-agw1-appGatewayFrontendIP", "location": "northeurope", "sku": "Basic", "properties": {"publicIPAllocationMethod": "Dynamic", "publicIPAddressVersion": "IPv4"}}, {"subscriptionId": "2a8545f9-dc4c-43f5-aea4-7a4a5df8c835", "resourceGroupName": "mspnp3", "id": "/subscriptions/2a8545f9-dc4c-43f5-aea4-7a4a5df8c835/resourceGroups/mspnp3/providers/Microsoft.Network/publicIPAddresses/my-test-agw2-appGatewayFrontendIP", "name": "my-test-agw2-appGatewayFrontendIP", "location": "northeurope", "sku": "Basic", "properties": {"publicIPAllocationMethod": "Dynamic", "publicIPAddressVersion": "IPv4"}}]}, "deploymentContext": {"value": {"parentTemplateUniqueString": "bb-001", "sasToken": ""}}}}